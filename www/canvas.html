<html>
<head>
<title>Canvas</title>
<style>
</style>
</head>

<body>

<script>
  nodes=[];
  edges=[];
  edgez=[];
  pool=[];
  colors=[]
  edgest=0;
  edgefirst=0;
  colorpool=["red","black","yellow","blue","coral","crimson","darkblue","gray"];
  function coloring2(){
	var len=nodes.length;
	var ender=1;
	colors[0]=1;
	pool[0]=0;
	for(var i=1; i<=len; i++){
		colors[i]=0;
		pool[i]=0;
	}
	for (var colornum=1; colornum<=len; colornum++){
		var flag=1;
		for (var i=1; i>0; ){
			if (i==len){
				for (var j=0; j<len; j++){
					nodes[j].color=colorpool[colors[j]-1];
				}
				draw.call();
				return;
			}
			flag=1;
			for(var k=0; k<=len; k++){
				pool[k]=0;
			}
			for(var j=0; j<edgez[i].length;j++){
				pool[colors[edgez[i][j]]]=1;
			}
			for (var j=colors[i]+1; j<=colornum; j++){
				if (pool[j]==0){
					colors[i]=j;
					i++;
					flag=0;
					break;
				}
			}
			if(flag==1){
				colors[i]=0;
				i--;
			}
		}
		colors[0]=1;
		for(var k=1; k<len; k++){
				colors[k]=0;
		}
		if (colornum>colorpool.length-1){
				colorpool.push('#'+Math.floor(Math.random()*16777215).toString(16));
		}
	}
	draw.call();
  }
  function coloring(){
	var len=nodes.length;
	var colornum=1;
	colors[0]=1;
	pool[0]=0;
	for(var i=1; i<=len; i++) {
		colors[i]=0;
		pool[i]=0;
	}
	for (var i=1; i<len; i++){
		for(var j=0; j<=colornum; j++){
			pool[j]=0;
		}
		for(var j=0; j<edgez[i].length;j++){
			pool[colors[edgez[i][j]]]=1;
		}
		for(var j=1; j<=colornum; j++){
			if (pool[j]==0){
				colors[i]=j;
				break;
			}
		}
		if (colors[i]==0){
			colornum++;
			colors[i]=colornum;
			if (colornum>colorpool.length){
				colorpool.push('#'+Math.floor(Math.random()*16777215).toString(16));
			}
		}
	}
	for (var j=1; j<=colornum; j++){
		for (var k=0; k<len;k++){
			if(colors[k]==j){
				nodes[k].color=colorpool[j-1];
			}
		}
	}
	draw.call();
  }
  function draw(){
	var canvas = document.getElementById("draw_canvas");
	var context = canvas.getContext("2d");
	context.clearRect(0,0,canvas.width,canvas.height);
	for (var i=0; i<edges.length; i++){
		var x1=nodes[edges[i].first].xcoord;
		var y1=nodes[edges[i].first].ycoord;
		var x2=nodes[edges[i].second].xcoord;
		var y2=nodes[edges[i].second].ycoord;
		context.beginPath();
		context.strokeStyle="black";
		context.moveTo(x1,y1);
		context.lineTo(x2,y2);
		context.stroke();
	}
	for (var i=0; i<nodes.length; i++){
		var x=nodes[i].xcoord;
		var y=nodes[i].ycoord;
		var color=nodes[i].color
		context.beginPath();
		context.arc(x,y,20,0,2*Math.PI);
		context.strokeStyle = "black";
		context.fillStyle = color;
		context.stroke();
		context.fill();
	}
	
  }
  function clickFunction(event) {
    var canvas = document.getElementById("draw_canvas");
    var context = canvas.getContext("2d");
    event = event || window.event;
    var x = event.pageX - canvas.offsetLeft;
    var y = event.pageY - canvas.offsetTop;
	var atnode=-1;
	for (var i=0; i<nodes.length; i++){
		var dist=Math.pow(nodes[i].xcoord-x,2)+Math.pow(nodes[i].ycoord-y,2);
		if (dist<1600){
			atnode=i;
			break;
		}
	}
    if(edgest==0&&atnode==-1){
	nodes[nodes.length]={xcoord:x, ycoord:y, color:"black"};
	context.beginPath();
    context.arc(x,y,20,0,2*Math.PI);
    context.strokeStyle = "black";
    context.fillStyle = "red";
    context.stroke();
    context.fill();
	edgez.push([]);
    }
	else{
		if (edgest==0){
			edgefirst=atnode;
			edgest=1;
		}
		else {
		//cancel edgest anyways, draw edge if it is a node and just cancel selection otherwise
			edgest=0;
			if(atnode==-1){
				nodes[edgefirst].xcoord=x;
				nodes[edgefirst].ycoord=y;
				draw.call();
			}
			else if(atnode!=edgefirst){
				context.beginPath();
				context.moveTo(nodes[atnode].xcoord,nodes[atnode].ycoord);
				context.lineTo(nodes[edgefirst].xcoord,nodes[edgefirst].ycoord);
				context.stroke();
				edgez[edgefirst].push(atnode);
				edgez[atnode].push(edgefirst);
				edgez[edgefirst].sort(function(a,b){return a-b});
				edgez[atnode].sort(function(a,b){return a-b});
				edges[edges.length]={first:edgefirst, second:atnode};
				var e = document.getElementById("srt").value;
				if(e=="greedy"){
					coloring.call();
				}
				else{
					coloring2.call();
				}
			}
		}
	
	}
    
  }
  
	function run() {
        document.getElementById("srt").value = document.getElementById("colorz").value;
		var e = document.getElementById("srt").value;
		if(e=="greedy"){
			coloring.call();
		}
		else{
			coloring2.call();
		}
	}
</script>
<select id="colorz" onchange="run()">  <!--Call run() function-->
     <option value="greedy">Greedy</option>
     <option value="optimal" selected>Optimal</option>
</select>
<input type="text" id="srt" placeholder="get value on option select"><br>
<center>
  <canvas id="draw_canvas" width="200" height="200" style="border:1px solid #000000;" onclick="clickFunction();"></canvas>
</center>

<script>
  var canvas = document.getElementById("draw_canvas");
  canvas.width = screen.width-50;;
  canvas.height = screen.height-150;
</script>

</body>

</html>
